import{a as Mi,b as Ai,c as Ri}from"./chunk-3YU5MEQP.js";import{a as Ii,b as W,c as U}from"./chunk-6A4HSIGC.js";import{a as Vi,b as Fi}from"./chunk-RQ6EJIW5.js";import{a as Li,c as Ti}from"./chunk-WCJAVGZ2.js";import{a as Ei,b as yi}from"./chunk-OACQ7NLW.js";import"./chunk-M2ZU7GXD.js";import{a as N}from"./chunk-RAT4GOAS.js";import{a as O,b as Q}from"./chunk-FEVRQCLI.js";import{b as si,c as ti,e as di,f as bi,g as ei,h as ni,j as Ci,k as xi,l as fi,o as vi,p as wi,q as j}from"./chunk-7N472BOY.js";import"./chunk-Q6IZA5MS.js";import"./chunk-XSSXK7EZ.js";import{a as J}from"./chunk-VHF434VP.js";import{a as zi,b as Bi}from"./chunk-ILOFINLE.js";import{a as $i}from"./chunk-TOTSVBZH.js";import{a as ki}from"./chunk-TWKP3DDW.js";import"./chunk-JLWJS3NC.js";import{k as Pi,u as Si,v as G,x as H}from"./chunk-VK5SKOH2.js";import{a as hi,b as gi}from"./chunk-H36UI7KJ.js";import"./chunk-YKOQL55W.js";import{a as E}from"./chunk-MACVMKOA.js";import{d as ui,f as _i}from"./chunk-YCONRSTD.js";import{i as mi,p as D,v as q}from"./chunk-AY5GOTEJ.js";import{Bb as R,Db as V,Eb as F,Fb as k,Hb as s,Ib as x,Jb as ci,Lb as Y,Mb as Z,Nb as ii,Ob as pi,Pb as z,Qa as l,Qb as B,T as I,Wb as w,Xb as S,Y as $,Z as g,ca as M,fb as f,g as ri,hb as u,kb as X,la as b,ma as C,mb as v,ob as y,pb as L,qb as o,rb as r,sb as m,ta as A,wb as h,xb as d,yb as a}from"./chunk-IAIY7PNC.js";var K=(()=>{let p=class p{constructor(t){this._http=t,this.urlApi=E.api,this.urlRuta="api/v1/comentario"}postComentario(t){return this._http.post(`${this.urlApi}${this.urlRuta}`,t)}deleteComentario(t,e){return this._http.put(`${this.urlApi}${this.urlRuta}/${t}`,e)}};p.\u0275fac=function(e){return new(e||p)($(q))},p.\u0275prov=I({token:p,factory:p.\u0275fac,providedIn:"root"});let n=p;return n})();var Ui=["menu"],Ji=(n,p)=>p.id_comentario;function Ki(n,p){if(n&1){let i=h();o(0,"button",10),d("click",function(e){b(i);let c=a().$implicit,_=a();return C(_.showEliminacion(e,c))}),r(),m(1,"p-menu",11,0)}if(n&2){let i=a(2);l(),u("model",i.accionesComentario)("popup",!0)}}function Xi(n,p){if(n&1&&(o(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),m(4,"p-avatar",6),o(5,"span"),s(6),r()()(),o(7,"div"),f(8,Ki,3,2),r()(),o(9,"div",7),s(10),r(),o(11,"div",8)(12,"span",9),s(13),w(14,"formatfecha"),r()()()),n&2){let i=p.$implicit,t=a();l(4),u("image",t.image+(i.autor==null?null:i.autor.foto_perfil)),l(2),x(i.autor==null||i.autor.usuario==null||i.autor.usuario.persona==null?null:i.autor.usuario.persona.nombre),l(2),v(8,i&&i.id_autor==t.idAutor?8:-1),l(2),ci(" ",i.contenido," "),l(3),x(S(14,5,i.fecha_registro))}}var Di=(()=>{let p=class p{constructor(){this.comentario=[],this.elementoEliminado=new A,this.idAutor=localStorage.getItem("id"),this.image=E.api,this.idComentario={},this.info={},this._serA=g(N),this._serC=g(K)}ngOnInit(){this._serA.getInformacionAutor(localStorage.getItem("id")).subscribe(t=>{this.info=t,console.log(t)}),this.accionesComentario=[{label:"Borrar",icon:"pi pi-trash",command:()=>this.eliminar(this.idComentario)}]}showEliminacion(t,e){this.menu.toggle(t),this.idComentario=e}eliminar(t){console.log(t),this._serC.deleteComentario(t.id_comentario,{id_estado:2}).subscribe(e=>{console.log(e),this.elementoEliminado.emit()})}};p.\u0275fac=function(e){return new(e||p)},p.\u0275cmp=M({type:p,selectors:[["app-lista"]],viewQuery:function(e,c){if(e&1&&V(Ui,5),e&2){let _;F(_=k())&&(c.menu=_.first)}},inputs:{comentario:"comentario"},outputs:{elementoEliminado:"elementoEliminado"},standalone:!0,features:[z],decls:3,vars:0,consts:[["menu",""],[2,"max-height","260px","overflow-y","auto"],[1,"p-2","m-2","border-round","surface-card","shadow-4","flex","flex-column"],[1,"flex","align-items-center","justify-content-between"],[1,"col-3"],[1,"flex","flex-row","gap-2","align-items-center"],["shape","circle","size","normal",3,"image"],[1,"col-12"],[1,"flex","justify-content-end"],[1,"fot-semibold","text-sm"],["pButton","","icon","pi pi-ellipsis-v",1,"p-ripple","p-button-rounded","p-button-text","p-button-plain",3,"click"],[3,"model","popup"]],template:function(e,c){e&1&&(o(0,"div",1),y(1,Xi,15,7,"div",2,Ji),r()),e&2&&(l(),L(c.comentario))},dependencies:[D,J,Q,O,H,G,j,U,W]});let n=p;return n})();var qi=(()=>{let p=class p{constructor(t){this._http=t,this.urlApi=E.api,this.urlRuta="api/v1/reaccion"}getListaReaccionAu(t){return this._http.get(`${this.urlApi}${this.urlRuta}/${t}`)}postReaccion(t){return this._http.post(`${this.urlApi}${this.urlRuta}`,t)}putReaccion(t,e){return this._http.put(`${this.urlApi}${this.urlRuta}/${t}`,e)}};p.\u0275fac=function(e){return new(e||p)($(q))},p.\u0275prov=I({token:p,factory:p.\u0275fac,providedIn:"root"});let n=p;return n})();var Yi=["menu"],Zi=["menuM"],it=(n,p)=>p.id_editorial_pl,li=(n,p)=>p.id_editorial,ji=()=>({width:"50vw"}),tt=()=>({"1199px":"75vw","575px":"90vw"});function et(n,p){if(n&1){let i=h();o(0,"button",25),d("click",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.showEdicion(e,c))}),r(),m(1,"p-menu",26,0)}if(n&2){let i=a(3);l(),u("model",i.acciones)("popup",!0)}}function nt(n,p){if(n&1){let i=h();o(0,"button",25),d("click",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.showEdicionM(e,c))}),r(),m(1,"p-menu",26,0)}if(n&2){let i=a(3);l(),u("model",i.accionesT)("popup",!0)}}function ot(n,p){if(n&1&&(o(0,"span",39),s(1,"Comentarios"),r(),m(2,"i",40)),n&2){let i=a(3).$implicit;l(2),u("value",i.comentario.length)}}function lt(n,p){if(n&1&&(o(0,"span",39),s(1,"Reacciones"),r(),m(2,"i",40)),n&2){let i=a(3).$implicit,t=a();l(2),u("value",t.contar(i.reaccion))}}function at(n,p){if(n&1&&(o(0,"div",38)(1,"div",41),m(2,"p-avatar",42),o(3,"span"),s(4),r()()()),n&2){let i=p.$implicit,t=a(4);l(2),u("image",t.imagen+(i.autor==null?null:i.autor.foto_perfil)),l(2),x(i.autor==null||i.autor.usuario==null||i.autor.usuario.persona==null?null:i.autor.usuario.persona.nombre)}}function rt(n,p){if(n&1){let i=h();m(0,"p-divider"),o(1,"p-tabView")(2,"p-tabPanel"),f(3,ot,3,1,"ng-template",27),o(4,"div",28)(5,"form",29)(6,"div",30)(7,"app-lista",31),d("elementoEliminado",function(){b(i);let e=a(3);return C(e.ActualizarComentarios())}),r()(),o(8,"div",32)(9,"div"),m(10,"p-avatar",33),r()(),o(11,"div",34)(12,"input",35),d("keypress",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.event(e,c.id_editorial_pl))}),r()(),o(13,"div",36)(14,"button",37),d("click",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.GuardarComentario(c.id_editorial_pl,e))}),r()()()()(),o(15,"p-tabPanel"),f(16,lt,3,1,"ng-template",27),y(17,at,5,2,"div",38,li),r()()}if(n&2){let i=a(2).$implicit,t=a();l(5),u("formGroup",t.formComentario),l(2),u("comentario",i.comentario),l(3),u("image",t.imagen+t.info.foto_perfil),l(4),u("disabled",t.formComentario.invalid),l(3),L(i.reaccion)}}function ct(n,p){if(n&1){let i=h();o(0,"div",9)(1,"div",10)(2,"div",11),m(3,"p-avatar",12),o(4,"span",13),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.irPerfilT(e.pl_libre[0].id_autor))}),s(5),r(),o(6,"span",14),s(7),w(8,"formatfecha"),r()(),o(9,"div",15),f(10,et,3,2)(11,nt,3,2),r()(),o(12,"div",16)(13,"span"),m(14,"p-chip",17),r(),o(15,"p",18),s(16),r()(),m(17,"p-divider"),o(18,"div",19)(19,"div",20),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.abrirComenatarios(e.id_editorial_pl))}),m(20,"p-chip",21),r(),o(21,"div",22)(22,"button",23),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.toggleSeguimiento(e.id_editorial_pl))}),r(),o(23,"button",24),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.Compartir(e.id_editorial_pl))}),r()()(),f(24,rt,19,4),r()}if(n&2){let i=a().$implicit,t=a();l(3),u("image",t.imagen+(i.pl_libre[0].autor==null?null:i.pl_libre[0].autor.foto_perfil)),l(2),x(i.pl_libre[0].autor==null||i.pl_libre[0].autor.usuario==null||i.pl_libre[0].autor.usuario.persona==null?null:i.pl_libre[0].autor.usuario.persona.nombre),l(2),x(S(8,8,i.fecha_registro)),l(3),v(10,i.pl_libre[0].id_autor==t.idAutor?10:11),l(4),u("label","Etiqueta: "+(i.pl_libre[0].etiqueta==null?null:i.pl_libre[0].etiqueta.nombre)),l(2),x(i.pl_libre[0].contenido),l(6),R("icon",t.iconSeguimiento(i.id_editorial_pl)),l(2),v(24,t.visualizacionComentarios[i.id_editorial_pl]?24:-1)}}function pt(n,p){if(n&1){let i=h();o(0,"button",25),d("click",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.showEdicion(e,c))}),r(),m(1,"p-menu",26,0)}if(n&2){let i=a(3);l(),u("model",i.acciones)("popup",!0)}}function mt(n,p){if(n&1){let i=h();o(0,"button",25),d("click",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.showEdicionM(e,c))}),r(),m(1,"p-menu",26,1)}if(n&2){let i=a(3);l(),u("model",i.accionesT)("popup",!0)}}function ut(n,p){if(n&1&&(o(0,"span",39),s(1,"Comentarios"),r(),m(2,"i",40)),n&2){let i=a(3).$implicit;l(2),u("value",i.comentario.length)}}function _t(n,p){if(n&1&&(o(0,"span",39),s(1,"Reacciones"),r(),m(2,"i",40)),n&2){let i=a(3).$implicit,t=a();l(2),u("value",t.contar(i.reaccion))}}function st(n,p){if(n&1&&(o(0,"div",38)(1,"div",41),m(2,"p-avatar",42),o(3,"span"),s(4),r()()()),n&2){let i=p.$implicit,t=a(4);l(2),u("image",t.imagen+(i.autor==null?null:i.autor.foto_perfil)),l(2),x(i.autor==null||i.autor.usuario==null||i.autor.usuario.persona==null?null:i.autor.usuario.persona.nombre)}}function dt(n,p){if(n&1){let i=h();m(0,"p-divider"),o(1,"p-tabView")(2,"p-tabPanel"),f(3,ut,3,1,"ng-template",27),o(4,"div",28)(5,"form",29)(6,"div",30)(7,"app-lista",31),d("elementoEliminado",function(){b(i);let e=a(3);return C(e.ActualizarComentarios())}),r()(),o(8,"div",32)(9,"div"),m(10,"p-avatar",33),r()(),o(11,"div",34)(12,"input",35),d("keypress",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.event(e,c.id_editorial_pl))}),r()(),o(13,"div",36)(14,"button",37),d("click",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.GuardarComentario(c.id_editorial_pl,e))}),r()()()()(),o(15,"p-tabPanel"),f(16,_t,3,1,"ng-template",27),y(17,st,5,2,"div",38,li),r()()}if(n&2){let i=a(2).$implicit,t=a();l(5),u("formGroup",t.formComentario),l(2),u("comentario",i.comentario),l(3),u("image",t.imagen+t.info.foto_perfil),l(4),u("disabled",t.formComentario.invalid),l(3),L(i.reaccion)}}function bt(n,p){if(n&1){let i=h();o(0,"div",9)(1,"div",43)(2,"div",11),m(3,"p-avatar",12),o(4,"span",13),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.irPerfilT(e.cap_pl_ln[0].pl_nl==null?null:e.cap_pl_ln[0].pl_nl.id_autor))}),s(5),r(),o(6,"span",14),s(7),w(8,"formatfecha"),r()(),o(9,"div",15),f(10,pt,3,2)(11,mt,3,2),r()(),o(12,"div",16)(13,"span",44),m(14,"p-chip",17),r(),o(15,"span"),m(16,"p-chip",17),r(),m(17,"span"),o(18,"p",45),s(19),r()(),m(20,"p-divider"),o(21,"div",19)(22,"div",20),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.abrirComenatarios(e.id_editorial_pl))}),m(23,"p-chip",21),r(),o(24,"div",22)(25,"button",23),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.toggleSeguimiento(e.id_editorial_pl))}),r(),o(26,"button",24),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.CompartirLibro(e.id_editorial_pl,e.cap_pl_ln))}),r()()(),f(27,dt,19,4),r()}if(n&2){let i=a().$implicit,t=a();l(3),u("image",t.imagen+(i.cap_pl_ln[0].pl_nl==null||i.cap_pl_ln[0].pl_nl.autor==null?null:i.cap_pl_ln[0].pl_nl.autor.foto_perfil)),l(2),x(i.cap_pl_ln[0].pl_nl==null||i.cap_pl_ln[0].pl_nl.autor==null||i.cap_pl_ln[0].pl_nl.autor.usuario==null||i.cap_pl_ln[0].pl_nl.autor.usuario.persona==null?null:i.cap_pl_ln[0].pl_nl.autor.usuario.persona.nombre),l(2),x(S(8,10,i.fecha_registro)),l(3),v(10,(i.cap_pl_ln[0].pl_nl==null?null:i.cap_pl_ln[0].pl_nl.id_autor)===t.idAutor?10:-1),l(),v(11,(i.cap_pl_ln[0].pl_nl==null?null:i.cap_pl_ln[0].pl_nl.id_autor)!=t.idAutor?11:-1),l(3),u("label","Libro: "+(i.cap_pl_ln[0].pl_nl==null?null:i.cap_pl_ln[0].pl_nl.titulo)),l(2),u("label",i.cap_pl_ln[0].nombre_capitulo),l(3),x(i.cap_pl_ln[0].contenido),l(6),R("icon",t.iconSeguimiento(i.id_editorial_pl)),l(2),v(27,t.visualizacionComentarios[i.id_editorial_pl]?27:-1)}}function Ct(n,p){if(n&1){let i=h();o(0,"button",25),d("click",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.showEdicion(e,c))}),r(),m(1,"p-menu",26,0)}if(n&2){let i=a(3);l(),u("model",i.acciones)("popup",!0)}}function xt(n,p){if(n&1){let i=h();o(0,"button",25),d("click",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.showEdicionM(e,c))}),r(),m(1,"p-menu",26,0)}if(n&2){let i=a(3);l(),u("model",i.accionesT)("popup",!0)}}function ft(n,p){if(n&1){let i=h();o(0,"div",47)(1,"div",10)(2,"div",11),m(3,"p-avatar",12),o(4,"span",13),d("click",function(){b(i);let e=a(2).$implicit,c=a();return C(c.irPerfilT(e==null||e.compartir==null||e.compartir[0]==null||e.compartir[0].compartir_datail==null||e.compartir[0].compartir_datail[0]==null||e.compartir[0].compartir_datail[0].editorial==null||e.compartir[0].compartir_datail[0].editorial.pl_libre==null||e.compartir[0].compartir_datail[0].editorial.pl_libre[0]==null?null:e.compartir[0].compartir_datail[0].editorial.pl_libre[0].id_autor))}),s(5),r()(),o(6,"div",15),m(7,"button",48),r()(),o(8,"div",16)(9,"span"),m(10,"p-chip",17),r(),o(11,"span",49),s(12),r()()()}if(n&2){let i=a(2).$implicit,t=a();l(3),u("image",t.imagen+(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.pl_libre==null||i.compartir[0].compartir_datail[0].editorial.pl_libre[0]==null||i.compartir[0].compartir_datail[0].editorial.pl_libre[0].autor==null?null:i.compartir[0].compartir_datail[0].editorial.pl_libre[0].autor.foto_perfil)),l(2),x(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.pl_libre==null||i.compartir[0].compartir_datail[0].editorial.pl_libre[0]==null||i.compartir[0].compartir_datail[0].editorial.pl_libre[0].autor==null||i.compartir[0].compartir_datail[0].editorial.pl_libre[0].autor.usuario==null||i.compartir[0].compartir_datail[0].editorial.pl_libre[0].autor.usuario.persona==null?null:i.compartir[0].compartir_datail[0].editorial.pl_libre[0].autor.usuario.persona.nombre),l(5),u("label","Etiqueta: "+(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.pl_libre==null||i.compartir[0].compartir_datail[0].editorial.pl_libre[0]==null||i.compartir[0].compartir_datail[0].editorial.pl_libre[0].etiqueta==null?null:i.compartir[0].compartir_datail[0].editorial.pl_libre[0].etiqueta.nombre)),l(2),x(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.pl_libre==null||i.compartir[0].compartir_datail[0].editorial.pl_libre[0]==null?null:i.compartir[0].compartir_datail[0].editorial.pl_libre[0].contenido)}}function vt(n,p){if(n&1&&(o(0,"div",47)(1,"div",43)(2,"div",11),m(3,"p-avatar",12),o(4,"span",50),s(5),r()(),o(6,"div",15),m(7,"button",48),r()(),o(8,"div",16)(9,"span",44),m(10,"p-chip",17),r(),o(11,"span"),m(12,"p-chip",17),r(),m(13,"span"),o(14,"span",49),s(15),r()()()),n&2){let i=a(2).$implicit,t=a();l(3),u("image",t.imagen+(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0]==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl.autor==null?null:i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl.autor.foto_perfil)),l(2),x(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0]==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl.autor==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl.autor.usuario==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl.autor.usuario.persona==null?null:i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl.autor.usuario.persona.nombre),l(5),u("label","Libro: "+(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0]==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl==null?null:i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].pl_nl.titulo)),l(2),u("label",i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0]==null?null:i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].nombre_capitulo),l(3),x(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0]==null?null:i.compartir[0].compartir_datail[0].editorial.cap_pl_ln[0].contenido)}}function ht(n,p){if(n&1&&(o(0,"span",39),s(1,"Comentarios"),r(),m(2,"i",40)),n&2){let i=a(3).$implicit;l(2),u("value",i.comentario.length)}}function gt(n,p){if(n&1&&(o(0,"span",39),s(1,"Reacciones"),r(),m(2,"i",40)),n&2){let i=a(3).$implicit,t=a();l(2),u("value",t.contar(i.reaccion))}}function Pt(n,p){if(n&1&&(o(0,"div",38)(1,"div",41),m(2,"p-avatar",42),o(3,"span"),s(4),r()()()),n&2){let i=p.$implicit,t=a(4);l(2),u("image",t.imagen+(i.autor==null?null:i.autor.foto_perfil)),l(2),x(i.autor==null||i.autor.usuario==null||i.autor.usuario.persona==null?null:i.autor.usuario.persona.nombre)}}function wt(n,p){if(n&1){let i=h();m(0,"p-divider"),o(1,"p-tabView")(2,"p-tabPanel"),f(3,ht,3,1,"ng-template",27),o(4,"div",28)(5,"form",29)(6,"div",30)(7,"app-lista",31),d("elementoEliminado",function(){b(i);let e=a(3);return C(e.ActualizarComentarios())}),r()(),o(8,"div",32)(9,"div"),m(10,"p-avatar",33),r()(),o(11,"div",34)(12,"input",35),d("keypress",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.event(e,c.id_editorial_pl))}),r()(),o(13,"div",36)(14,"button",37),d("click",function(e){b(i);let c=a(2).$implicit,_=a();return C(_.GuardarComentario(c.id_editorial_pl,e))}),r()()()()(),o(15,"p-tabPanel"),f(16,gt,3,1,"ng-template",27),y(17,Pt,5,2,"div",38,li),r()()}if(n&2){let i=a(2).$implicit,t=a();l(5),u("formGroup",t.formComentario),l(2),u("comentario",i.comentario),l(3),u("image",t.imagen+t.info.foto_perfil),l(4),u("disabled",t.formComentario.invalid),l(3),L(i.reaccion)}}function St(n,p){if(n&1){let i=h();o(0,"div",9)(1,"div",10)(2,"div",11),m(3,"p-avatar",12),o(4,"span",13),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.irPerfilT(e.compartir[0].id_autor))}),s(5),r(),o(6,"span",14),s(7),w(8,"formatfecha"),r(),o(9,"span"),s(10," --> compartio"),r()(),o(11,"div",15),f(12,Ct,3,2)(13,xt,3,2),r()(),o(14,"div",16)(15,"span",46),s(16),r()(),o(17,"div"),f(18,ft,13,4,"div",47)(19,vt,16,5,"div",47),m(20,"p-divider"),o(21,"div",19)(22,"div",20),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.abrirComenatarios(e.id_editorial_pl))}),m(23,"p-chip",21),r(),o(24,"div",22)(25,"button",23),d("click",function(){b(i);let e=a().$implicit,c=a();return C(c.toggleSeguimiento(e.id_editorial_pl))}),r()()(),f(26,wt,19,4),r()()}if(n&2){let i=a().$implicit,t=a();l(3),u("image",t.imagen+(i.compartir[0].autor==null?null:i.compartir[0].autor.foto_perfil)),l(2),x(i.compartir[0].autor==null||i.compartir[0].autor.usuario==null||i.compartir[0].autor.usuario.persona==null?null:i.compartir[0].autor.usuario.persona.nombre),l(2),x(S(8,9,i.fecha_registro)),l(5),v(12,i.compartir[0].id_autor==t.idAutor?12:13),l(4),x(i.compartir[0].cotenido),l(2),v(18,!(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null)&&i.compartir[0].compartir_datail[0].editorial.pl_libre&&(!(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.pl_libre==null)&&i.compartir[0].compartir_datail[0].editorial.pl_libre.length)?18:-1),l(),v(19,!(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null)&&i.compartir[0].compartir_datail[0].editorial.cap_pl_ln&&(!(i==null||i.compartir==null||i.compartir[0]==null||i.compartir[0].compartir_datail==null||i.compartir[0].compartir_datail[0]==null||i.compartir[0].compartir_datail[0].editorial==null||i.compartir[0].compartir_datail[0].editorial.cap_pl_ln==null)&&i.compartir[0].compartir_datail[0].editorial.cap_pl_ln.length)?19:-1),l(6),R("icon",t.iconSeguimiento(i.id_editorial_pl)),l(),v(26,t.visualizacionComentarios[i.id_editorial_pl]?26:-1)}}function Et(n,p){if(n&1&&f(0,ct,25,10,"div",9)(1,bt,28,12,"div",9)(2,St,27,11,"div",9),n&2){let i=p.$implicit;v(0,i.pl_libre&&i.pl_libre.length>0?0:-1),l(),v(1,i.cap_pl_ln&&i.cap_pl_ln.length>0?1:-1),l(),v(2,i.compartir&&i.compartir.length>0?2:-1)}}function yt(n,p){if(n&1&&(o(0,"div",5)(1,"div",43)(2,"div",11),m(3,"p-avatar",12),o(4,"span",50),s(5),r(),o(6,"span",14),s(7),w(8,"formatfecha"),r()()(),o(9,"div",16)(10,"span",44),m(11,"p-chip",17),r(),o(12,"span"),m(13,"p-chip",17),r(),m(14,"span"),o(15,"span",49),s(16),r()()()),n&2){let i=a();l(3),u("image",i.imagen+(i.obtenerPlLibro.cap_pl_ln[0].pl_nl==null||i.obtenerPlLibro.cap_pl_ln[0].pl_nl.autor==null?null:i.obtenerPlLibro.cap_pl_ln[0].pl_nl.autor.foto_perfil)),l(2),x(i.obtenerPlLibro.cap_pl_ln[0].pl_nl==null||i.obtenerPlLibro.cap_pl_ln[0].pl_nl.autor==null||i.obtenerPlLibro.cap_pl_ln[0].pl_nl.autor.usuario==null||i.obtenerPlLibro.cap_pl_ln[0].pl_nl.autor.usuario.persona==null?null:i.obtenerPlLibro.cap_pl_ln[0].pl_nl.autor.usuario.persona.nombre),l(2),x(S(8,6,i.obtenerPlLibro.fecha_registro)),l(4),u("label","Libro: "+(i.obtenerPlLibro.cap_pl_ln[0].pl_nl==null?null:i.obtenerPlLibro.cap_pl_ln[0].pl_nl.titulo)),l(2),u("label",i.obtenerPlLibro.cap_pl_ln[0].nombre_capitulo),l(3),x(i.obtenerPlLibro.cap_pl_ln[0].contenido)}}function Lt(n,p){if(n&1&&(o(0,"div",5)(1,"div",43)(2,"div",11),m(3,"p-avatar",12),o(4,"span",50),s(5),r(),o(6,"span",14),s(7),w(8,"formatfecha"),r()()(),o(9,"div",16)(10,"span",49),s(11),r()()()),n&2){let i=a(2);l(3),u("image",i.imagen+(i.obtenerPblicacion&&i.obtenerPblicacion.pl_libre&&(i.obtenerPblicacion.pl_libre[0].autor==null?null:i.obtenerPblicacion.pl_libre[0].autor.foto_perfil))),l(2),x(i.obtenerPblicacion&&i.obtenerPblicacion.pl_libre&&(i.obtenerPblicacion.pl_libre[0].autor==null||i.obtenerPblicacion.pl_libre[0].autor.usuario==null||i.obtenerPblicacion.pl_libre[0].autor.usuario.persona==null?null:i.obtenerPblicacion.pl_libre[0].autor.usuario.persona.nombre)),l(2),x(S(8,4,i.obtenerPblicacion.fecha_registro)),l(4),x(i.obtenerPblicacion&&i.obtenerPblicacion.pl_libre&&i.obtenerPblicacion.pl_libre[0].contenido)}}function Tt(n,p){if(n&1&&f(0,Lt,12,6,"div",5),n&2){let i=a();v(0,i.obtenerPblicacion?0:-1)}}var Fe=(()=>{let p=class p{constructor(){this.data=new A,this.idVa=0,this.visible=!1,this.idEditorialModal=null,this.idEditorialC=0,this.idAutor=parseInt(localStorage.getItem("id")),this.imagen=E.api,this.publicacionSeleccionada=[],this.listaReacciones=[],this.visualizacionComentarios={},this.comentar=!1,this.compartir=!1,this.info={},this._serA=g(N),this._publicacione=g(ki),this._comentario=g(K),this._reaccion=g(qi),this._r=g(_i),this._ra=g(ui),this._location=g(mi),this._ec=g($i),this._acc=g(Ii)}ngOnInit(){this.formCompartir=new ei({contenidocompartir:new ni("",ti.required)}),this.acciones=[{label:"Todo el contenido",icon:"",command:()=>this.verContenidoCompleto(this.editEditorial)},{label:"Editar",icon:"pi pi-pencil",command:()=>this.editar(this.editEditorial)},{label:"Borrar",icon:"pi pi-trash",command:()=>this.eliminar(this.editEditorial)}],this.accionesT=[{label:"Todo el contenido",icon:"",command:()=>this.verContenidoCompleto(this.editEditorial)}],this.loadPublicaciones(),this.userUpdateSubscription=this._publicacione.onUserUpdate().subscribe(()=>{this.loadPublicaciones()}),this._serA.getInformacionAutor(localStorage.getItem("id")).subscribe(t=>{this.info=t,console.log(t)}),this.formComentario=new ei({contenido:new ni("",ti.required)}),this.listaReaccion(),this._ra.paramMap.subscribe(t=>{this.idEditorialModal=t.get("id"),this.visible=!!this.idEditorialModal})}listaReaccion(){return ri(this,null,function*(){this._reaccion.getListaReaccionAu(localStorage.getItem("id")).subscribe({next:t=>{this.listaReacciones=t}})})}toggleSeguimiento(t){let e=this.listaReacciones.find(P=>P.id_editorial===t),c={id_editorial:t,estado:e&&e.estado===1?2:1};console.log(e);let _=e==null?this._reaccion.postReaccion({id_editorial:t,tipo:2,estado:1,id_autor:localStorage.getItem("id")}):this._reaccion.putReaccion(localStorage.getItem("id"),c);console.log(_),_.subscribe(P=>{this.listaReaccion();let Gi=this.listaReacciones.slice(),ai=this.listaReacciones.filter(T=>!Gi.some(Hi=>Hi.id_editorial===T.id_editorial));ai.length>0&&this.listaReacciones.push(...ai),this.listaReacciones.find(T=>T.id_editorial==t)?.estado==2||this.listaReacciones.find(T=>T.id_editorial==t)?.estado==null&&this._acc.postActividad({id_autor:localStorage.getItem("id"),tipo_actividad:"like r"+P.id}).subscribe(T=>{this._acc.notificarActualizacion()}),this.loadPublicaciones(),this.usuarioget(t)})}contar(t){return t.filter(c=>c.estado===1).length}usuarioget(t){let e=this.listaReacciones.find(c=>c.id_editorial===t);return e?e.estado:2}iconSeguimiento(t){return this.usuarioget(t)===2?"pi pi-heart text-2xl":"pi pi-check text-2xl"}loadPublicaciones(){this._publicacione.getListaPublicaciones().subscribe({next:t=>{this.listaPulicaciones=t,console.log(t)},error:t=>{this.data.emit({estado:!1,datos:t})}})}editar(t){this._publicacione.sendData({i:!0,datos:t})}eliminar(t){this._publicacione.putDeletePublicacion(t.id_editorial_pl,{id_estado:2}).subscribe({next:e=>{this.loadPublicaciones()},error:e=>{this.data.emit({estado:!1,datos:e})}})}showEdicion(t,e){t.preventDefault(),this.menu.toggle(t),this.editEditorial=e}showEdicionM(t,e){t.preventDefault(),this.menuM.toggle(t),this.editEditorial=e}abrirComenatarios(t){console.log(t),console.log(this.visualizacionComentarios),this.visualizacionComentarios[t]=this.visualizacionComentarios?!this.visualizacionComentarios[t]:!this.visualizacionComentarios[t]}ActualizarComentarios(){this.loadPublicaciones()}GuardarComentario(t,e){if(e.preventDefault(),this.formComentario.valid){let c={id_autor:localStorage.getItem("id"),id_editorial:t,tipo:4,contenido:this.formComentario.get("contenido")?.value};this._comentario.postComentario(c).subscribe({next:_=>{this._acc.postActividad({id_autor:localStorage.getItem("id"),tipo_actividad:"com "+_.id}).subscribe(P=>{this._acc.notificarActualizacion()}),this.formComentario.reset(),this.loadPublicaciones()},error:_=>{console.log(_)}})}}Compartir(t){console.log(t),console.log(this.obtenerPlLibro),this.obtenerPlLibro=void 0,this.compartir=!0,this._publicacione.ObtnerListPublicacion(t).subscribe(e=>{console.log(e),this.obtenerPblicacion=e,this.idEditorialC=e.id_editorial_pl,this.clearObject(this.obtenerPlLibro)})}CompartirLibro(t,e){this.compartir=!0,this.obtenerPblicacion=void 0,this._publicacione.ObtenerListPublicacionLibro(t,e[0].id_cap_pl).subscribe(c=>{console.log(c),this.obtenerPlLibro=c,this.idEditorialC=c.id_editorial_pl,this.clearObject(this.obtenerPblicacion)})}guardarCompartir(){if(this.formCompartir.valid){let t={id_autor:localStorage.getItem("id"),id_categoria:4,contenido:this.formCompartir.get("contenidocompartir")?.value,id_editorial_pl:this.idEditorialC};this._publicacione.compartirPublicacion(t).subscribe(e=>{this._acc.postActividad({id_autor:localStorage.getItem("id"),tipo_actividad:"com "+e.id}).subscribe(c=>{this._acc.notificarActualizacion()}),this.formCompartir.reset(),this.loadPublicaciones(),this.compartir=!1})}}hidemodalCompartir(){this.obtenerPblicacion=void 0,this.obtenerPlLibro=void 0,this.idEditorialC=0,console.log(this.obtenerPlLibro)}clearObject(t){for(let e in t)t.hasOwnProperty(e)&&(t[e]=null)}event(t,e){console.log(t),t.key==="Enter"&&this.GuardarComentario(e,t)}irPerfilT(t){this._ec.navigateToProfile(t)}HideModal(){this.visible=!1}verContenidoCompleto(t){this.visible=!0}};p.\u0275fac=function(e){return new(e||p)},p.\u0275cmp=M({type:p,selectors:[["app-lista-publicaciones"]],viewQuery:function(e,c){if(e&1&&(V(Yi,5),V(Zi,5)),e&2){let _;F(_=k())&&(c.menu=_.first),F(_=k())&&(c.menuM=_.first)}},outputs:{data:"data"},standalone:!0,features:[pi([]),z],decls:11,vars:19,consts:[["menu",""],["menuM",""],["header","Compartir publicacion",3,"visibleChange","onHide","visible","modal","breakpoints","draggable","resizable"],[3,"formGroup"],["pInputTextarea","","id","","formControlName","contenidocompartir","rows","2",1,"w-full","my-2"],[1,"surface-card","shadow-3","p-2","border-round"],["pButton","","label","Compartir",1,"w-full","mt-2",3,"click","disabled"],["header","Header",3,"visibleChange","onHide","visible","modal","draggable","resizable"],[1,"m-0"],[1,"surface-card","p-4","shadow-2","border-round","my-2"],[1,"mb-2","flex","align-items-center","justify-content-between","cursor-pointer"],[1,"flex","align-items-center","gap-2"],["size","large","shape","circle",3,"image"],[1,"capitalize","font-bold",3,"click"],[1,"ml-2"],[1,""],[1,"flex","flex-column","gap-2"],[3,"label"],[1,"white-space-normal"],[1,"flex","flex-row","justify-content-between"],[3,"click"],["label","Comentar",1,"cursor-pointer"],[1,"flex","gap-2"],["pButton","",1,"p-ripple","p-button-rounded","p-button-text","p-button-plain",3,"click","icon"],["pButton","","icon","pi pi-share-alt text-2xl",1,"p-ripple","b-button-rounded","p-button-text","p-button-plain",3,"click"],["pButton","","icon","pi pi-ellipsis-v",1,"p-ripple","p-button-rounded","p-button-text","p-button-plain",3,"click"],[3,"model","popup"],["pTemplate","header"],[1,"flex","flex-column"],[1,"grid","justify-content-center","align-items-center",3,"formGroup"],[1,"col-12"],[3,"elementoEliminado","comentario"],[1,"col-2"],["shape","circle","size","large",3,"image"],[1,"col"],["pInputText","","placeholder","Realizar un comentario","formControlName","contenido",1,"w-full",3,"keypress"],[1,"col-1"],["pButton","","icon","pi pi-send text-2xl",1,"p-ripple","p-button-rounded","p-button-text","p-button-plain",3,"click","disabled"],[1,"surface-card","shadow-2","p-2","m-2","border-round"],[1,"mr-4"],["pBadge","",3,"value"],[1,"flex","flex-row","align-items-center"],["shape","circle",3,"image"],[1,"mb-2","flex","align-items-center","justify-content-between"],[1,"capitalize"],[1,"px-4","white-space-normal"],[1,"py-2"],[1,"p-4","border-bluegray-300","border-1","border-round","my-2"],["pButton","","icon","pi pi-ellipsis-v",1,"p-ripple","p-button-rounded","p-button-text","p-button-plain"],[1,"p-4"],[1,"capitalize","font-bold"]],template:function(e,c){e&1&&(y(0,Et,3,3,null,null,it),o(2,"p-dialog",2),ii("visibleChange",function(P){return Z(c.compartir,P)||(c.compartir=P),P}),d("onHide",function(){return c.hidemodalCompartir()}),o(3,"form",3),m(4,"textarea",4),f(5,yt,17,8,"div",5)(6,Tt,1,1),o(7,"button",6),d("click",function(){return c.guardarCompartir()}),r()()(),o(8,"p-dialog",7),ii("visibleChange",function(P){return Z(c.visible,P)||(c.visible=P),P}),d("onHide",function(){return c.HideModal()}),o(9,"p",8),s(10," Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. "),r()()),e&2&&(L(c.listaPulicaciones),l(2),X(B(16,ji)),Y("visible",c.compartir),u("modal",!0)("breakpoints",B(17,tt))("draggable",!1)("resizable",!1),l(),u("formGroup",c.formCompartir),l(2),v(5,c.obtenerPlLibro?5:6),l(2),u("disabled",c.formCompartir.invalid),l(),X(B(18,ji)),Y("visible",c.visible),u("modal",!0)("draggable",!1)("resizable",!1))},dependencies:[D,J,Ti,Li,Pi,yi,Ei,Ri,Ai,Mi,vi,Ci,si,di,bi,xi,fi,Q,O,Di,H,G,j,wi,Fi,Vi,Si,U,W,gi,hi,Bi,zi]});let n=p;return n})();export{Fe as default};
